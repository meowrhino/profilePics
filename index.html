<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>profile pics</title>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Agdasima:wght@400;700&display=swap" rel="stylesheet">

    <style>
        body {
            text-align: center;
            font-family: "Agdasima", sans-serif;
            font-weight: 400;

            display: flex;
            flex-direction: column;
            justify-content: center;

            color: #333;

            margin: 0;
        }

        .gallery {
            display: flex;
            white-space: nowrap;
            gap: 50px;
            overflow: scroll;
        }

        .profilePic {
            width: 512px;
            height: 512px;
        }

        .text {
            max-width: 820px;
            margin-left: auto;
            margin-right: auto;
            padding: 40px, 0px;

        }

        a {
            text-decoration: none;
            color: lightgray;
            transition: transform 0.3s ease, font-weight 0.3s ease;
        }

        /*no sé por qué ésto no va*/
        a:hover {
            font-weight: bolder !important;
            font-size: 22px !important;
            transform: scale(1.1) !important;
        }
    </style>
</head>

<body>
  <!-- Aquí muestra el número de la imagen centrada -->
  <div id="current-number">0</div>

  <!-- Galería scrollable -->
  <div class="gallery"></div>

    <script>
        const cantidadDeFotos = 388;
        const imgWidth = 512;
        const imgGap = 50;

        const gallery = document.querySelector(".gallery");
        const currentNumberEl = document.getElementById("current-number");

        function calculateMargin() {
            //this way each time you call the function this value is updated
            screenWidth = document.documentElement.scrollWidth;

            let marginToAdd = screenWidth / 2 - imgWidth / 2 - imgGap;
            return marginToAdd;
        }

        //and this function will create an empty div, we'll just call it before the loop that loads the pictures and after it

        function addScrollMargin() {
      const marginDiv = document.createElement("div");
      marginDiv.classList.add("galleryMargin");
      // Aplica sólo margin-left y margin-right
      marginDiv.style.width = `${calculateMargin()}px`;
      gallery.appendChild(marginDiv);
        }

    // Poblamos la galería con margen inicial, imagen 0, resto de imágenes y margen final
    function populateGallery() {
        addScrollMargin();

            // Primera imagen (0.jpg)
            const zeroImg = document.createElement("img");
      zeroImg.src = "img/0.jpg";
      zeroImg.classList.add("profilePic");
      gallery.appendChild(zeroImg);

      // Resto de imágenes (1.png … cantidadDeFotos.png)
      for (let i = cantidadDeFotos; i > 0; i--) {
        const img = document.createElement("img");
        img.src = `img/${i}.png`;
        img.classList.add("profilePic");
        gallery.appendChild(img);
      }

        for (i = cantidadDeFotos; i > 0; i--) {
            let image = document.createElement("img");
            image.src = `img/${i}.png`;
            image.classList.add("profilePic");
            gallery.appendChild(image);
        }

        addScrollMargin();
    }

    // Encuentra la imagen cuyo centro está más cercano al centro del viewport
    function updateCurrentImage() {
      const images = document.querySelectorAll('.profilePic');
      const galleryRect = gallery.getBoundingClientRect();
      const galleryCenterX = galleryRect.left + galleryRect.width / 2;

      let closestImg = null;
      let minDiff = Infinity;

      images.forEach(img => {
        const rect = img.getBoundingClientRect();
        const imgCenterX = rect.left + rect.width / 2;
        const diff = Math.abs(imgCenterX - galleryCenterX);
        if (diff < minDiff) {
          minDiff = diff;
          closestImg = img;
        }
      });

      if (closestImg) {
        const src = closestImg.getAttribute('src');
        const match = src.match(/\/(\d+)\.\w+$/);
        const num = match ? match[1] : '';
        currentNumberEl.textContent = num;
      }
    }

    // Inicializamos
    populateGallery();
    updateCurrentImage();

    // Listeners
    gallery.addEventListener('scroll', () => {
      // opcional: podrías "throttlear" esta llamada si es necesario
      updateCurrentImage();
    });

    window.addEventListener('resize', () => {
      // recalcula márgenes y número al cambiar el tamaño
      document.querySelectorAll('.galleryMargin').forEach(m => {
        m.style.width = `${calculateMargin()}px`;
      });
      updateCurrentImage();
    });
    </script>
</body>

</html>
